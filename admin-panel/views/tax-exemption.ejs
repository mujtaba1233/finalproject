<%- include header.ejs %>
<div ng-controller="TaxExemptionController">
    <div class="row">
        <div class="col-md-6">
            <h2>Tax Exemption Management</h2>
        </div>
    </div>
    <div class="row">
        <form class="w-100" id="userform" ng-submit="save()">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="row">
                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 form-group">
                        <label>Customer
                            <p class="explanation">Selecting a customer will only auto fill the fields below, Tax
                                exemption will be given against the Address.</p>
                        </label>

                        <select chosen class="form-control"
                            ng-options="c as c.FirstName + ' ' + c.LastName for c in customers"
                            ng-change="fillAddress()" ng-model="customer">
                        </select>
                    </div>
                </div>
            </div>
            <div class="col-lg-12">
                <div class="row">
                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 form-group">
                        <label>Address 1 <span class="text-danger">*</span></label>
                        <input required type="text" ng-model="taxExem.address1" class="form-control">
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 form-group">
                        <label>Address 2</label>
                        <input type="text" ng-model="taxExem.address2" class="form-control">
                    </div>
                </div>
            </div>
            <div class="col-lg-12">
                <div class="row">
                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 form-group">
                        <label>City <span class="text-danger">*</span></label>
                        <input required type="text" ng-model="taxExem.city" class="form-control">
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 form-group">
                        <label>State <span class="text-danger">*</span></label>
                        <input required type="text" ng-model="taxExem.state" class="form-control">
                    </div>
                </div>
            </div>
            <div class="col-lg-12">
                <div class="row">
                    <div class="col-lg-3 col-md-3 col-sm-6 col-xs-6 form-group">
                        <label>Company</label>
                        <input type="text" ng-model="taxExem.company" class="form-control">
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-6 col-xs-6 form-group">
                        <label>Postal Code <span class="text-danger">*</span></label>
                        <input required type="text" ng-model="taxExem.postalCode" class="form-control">
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 form-group">
                        <label>Country <span class="text-danger">*</span></label>
                        <input required type="text" ng-model="taxExem.country" class="form-control">
                    </div>
                </div>
            </div>
            <div class="col-lg-12">
                <div class="row">
                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 form-group">
                        <label>Tax Exemption From <span class="text-danger">*</span>
                            <p class="explanation">start of tax exemption date</p>
                        </label>
                        <input required type="date" ng-model="taxExem.dateFrom" class="form-control">
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 form-group">
                        <label>Tax Exemption Till <span class="text-danger">*</span>
                            <p class="explanation">end of tax exemption date</p>
                        </label>
                        <input required type="date" ng-model="taxExem.dateTill" class="form-control">
                    </div>
                </div>
            </div>
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 form-group">
                <input type="checkbox" ng-model="taxExem.isActive"> Active
            </div>
    </div>
    <div class="row">
        <div class="col-md-12 form-group">
            <button type="submit" title="{{updateFlag? 'Update User': 'Save User'}}"
                class="btn {{updateFlag? 'btn-primary': 'btn-success'}} pull-right btn-lg">{{updateFlag? 'Update': 'Save'}}</button>

            <button style="margin-right: 5px;" ng-if="updateFlag" title="Cancel" ng-click="cancelUpdate()"
                class="btn btn-warning pull-right btn-lg">Cancel</button>
        </div>
    </div>
    </form>
    <table st-table="taxExemsTemp" st-safe-src="taxExems" class="table table-striped table-hover table-scroll" id="table-scroll">
        <thead>
            <tr>
                <th style="width: 12%" st-sort="company">Company</th>
                <th style="width: 13%; text-align: center;" st-sort="address1">Address</th>
                <th style="width: 10%; text-align: center;" st-sort="city">City</th>
                <th style="width: 10%; text-align: center;" st-sort="state">State</th>
                <th style="width: 10%; text-align: center;" st-sort="postalCode">Postal Code</th>
                <th style="width: 10%; text-align: center;" st-sort="country">Country</th>
                <th style="width: 10%; text-align: center;" st-sort="dateFrom">From</th>
                <th style="width: 10%; text-align: center;" st-sort="dateTill">Till</th>
                <th style="width: 5%" st-sort="isActive">Active</th>
                <th style="width: 10%; text-align:right;">Action</th>
            </tr>
            <tr>

                <th colspan="10">
                    <input st-search="" class="form-control" placeholder="global search ..." type="text" />
                </th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="taxExem in taxExemsTemp">
                <td>{{taxExem.company}}</td>
                <td class="text-center">{{taxExem.address1}}</td>
                <td class="text-center">{{taxExem.city}}</td>
                <td class="text-center">{{taxExem.state}}</td>
                <td class="text-center">{{taxExem.postalCode}}</td>
                <td class="text-center">{{taxExem.country}}</td>
                <td class="text-center">{{parseDate(taxExem.dateFrom) | date:'MM-dd-yyyy'}}</td>
                <td class="text-center">{{parseDate(taxExem.dateTill) | date:'MM-dd-yyyy'}}</td>
                <td class="{{taxExem.isActive == 1? 'text-success' : 'text-danger'}}">
                    {{taxExem.isActive == 1? "Active" : "In-Active"}}</td>
                <td class="text-right">
                    <a title="Edit" href="javascript:void(0)" ng-click="update(taxExem)" class="btn btn-sm btn-primary">
                        <i class="fa fa-pencil">
                        </i>
                    </a>
                    <a title="Remove" href="javascript:void(0)" ng-click="delete(taxExem,$index)"
                        class="btn btn-sm btn-danger">
                        <i class="fa fa-trash">
                        </i>
                    </a>
                </td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td colspan="10"  class="text-center d-flex justify-content-center tfoot-toggle">
                    <div class="paging">
                        <div st-pagination=""  st-template="template/st-pagination.html" st-items-by-page="itemsByPage" st-displayed-pages="7"></div>
                    </div>
                </td>
            </tr>
        </tfoot>
    </table>
</div>


<%- include footer.ejs %>