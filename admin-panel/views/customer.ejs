<%- include header.ejs %>
<div ng-controller="CustomersController">
	<div class="row">
		<div class="col-md-6">
			<h2> Customer Management </h2>
		</div>
	</div>
	<form id="userform">
		<div class="row">
			<div class="col-md-3 form-group">
				<label>First Name<span class="text-danger">*</span></label>
				<input
					required
					type="text"
					ng-model="customer.FirstName"
					class="custom-input form-control"
				/>
			</div>
			<div class="col-md-3 form-group">
				<label>Last Name<span class="text-danger">*</span></label>
				<input
					required
					type="text"
					ng-model="customer.LastName"
					class="custom-input form-control"
				/>
			</div>
			<div class="col-md-3 form-group">
				<label>Email<span class="text-danger">*</span></label>
				<input
				ng-disabled="update"
					required
					type="email"
					ng-model="customer.EmailAddress"
					class="custom-input form-control"
				/>
			</div>
			<div class="col-md-3 form-group">
				<label>Company<span class="text-danger">*</span></label>
				<input
					required
					type="text"
					ng-model="customer.CompanyName"
					class="custom-input form-control"
				/>
			</div>
			<div class="col-md-3 form-group">
				<label>Billing Address 1<span class="text-danger">*</span></label>
				<input
					required
					type="text"
					ng-model="customer.BillingAddress1"
					class="custom-input form-control"
				/>
			</div>
			<div class="col-md-3 form-group">
				<label>Billing Address 2</label>
				<input
					type="text"
					ng-model="customer.BillingAddress2"
					class="custom-input form-control"
				/>
			</div>
			<div class="col-md-3 form-group">
				<label>City<span class="text-danger">*</span></label>
				<input
					required
					type="text"
					ng-model="customer.City"
					class="custom-input form-control"
				/>
			</div>
			<div class="col-md-3 form-group">
				<label>Postal Code</label>
				<input
					type="text"
					ng-model="customer.PostalCode"
					class="custom-input form-control"
					maxlength="16"
					onkeypress="zipFormat(event)"
				/>
			</div>
			<div class="col-md-3 form-group">
				<label>State</label>
				<input
					type="text"
					ng-model="customer.State"
					class="custom-input form-control"
				/>
			</div>
			<div class="col-md-3 form-group">
				<label>Country<span class="text-danger">*</span></label>
				<!-- <input required type="text" ng-model="customer.Country" class="form-control"> -->
				<select
					ng-model="customer.Country"
					ng-options="c.code as c.name  for c in countries"
					class="custom-input form-control"
				>
					<option value="">Select Country</option>
				</select>
			</div>
			<div class="col-md-3 form-group">
				<label>Phone Number<span class="text-danger">*</span></label>
				<input
					required
					type="text"
					onkeypress="PhoneFormat(event)"
					ng-change="stickToPhoneFormat()"
					ng-model-options="{debounce: 100}"
					maxlength="25"
					ng-model="customer.PhoneNumber"
					class="custom-input form-control"
				/>
			</div>
			<div class="col-md-3 form-group">
				<label>Discount (%)</label>
				<input
					type="text"
					ng-model="customer.CustomerDiscount"
					class="custom-input form-control"
				/>
			</div>
			<div class="col-lg-12">
				<div class="row">
					<div class="col-md-2 form-group">
						<input type="checkbox" ng-model="customer.Active" /> Active
					</div>
					<div class="col-md-1 form-group">
						<input type="checkbox" checked ng-model="customer.hide" /> Hide
					</div>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-12 form-group">
				<button
					ng-click="saveCustomer()"
					ng-if="!update"
					title="Save customer"
					class="btn {{ update ? 'btn-primary' : 'btn-success' }} pull-right"
					>Save</button
				>
				<button
					ng-click="updateCustomerRecord()"
					ng-if="update"
					title="Update customer"
					class="btn {{ update ? 'btn-primary' : 'btn-success' }} pull-right"
					>Update</button
				>
				<button
					style="margin-right: 5px"
					ng-if="update || cloned"
					title="Cancel"
					ng-click="cancelUpdate()"
					class="btn btn-warning pull-right"
					>Cancel</button
				>
			</div>
		</div>
	</form>
	<table
		st-table="records"
		st-safe-src="customers"
		class="table table-striped table-hover table-user table-scroll"
		id="table-scroll"
	>
		<thead>
			<tr>
				<button
					type="button"
					class="btn btn-outline-success mb-2 pull-right"
					ng-click="updateExportFileName(true)"
					ng-csv="customers"
					csv-header="selectedOptions"
					csv-column-order="selectedOptions"
					filename="customer.csv"
					><i class="fa fa-file"></i> Export {{ customers.length }} Customers
				</button>
			</tr>
			<tr>
				<th style="width: 10%" st-sort="id">First Name</th>
				<th style="width: 15%" st-sort="lastname">Last Name</th>
				<th style="width: 20%" st-sort="email">Email Address</th>
				<th style="width: 15%" st-sort="usertype">Company Name</th>
				<th style="width: 20%" st-sort="email">City</th>
				<th style="width: 15%" st-sort="usertype">Postal Code</th>
				<th style="width: 15%" st-sort="usertype">Country</th>
				<th style="width: 15%" st-sort="usertype">PhoneNumber</th>
				<th style="width: 15%" st-sort="usertype">Action</th>
			</tr>
			<tr>
				<th colspan="12">
					<input
						st-search=""
						class="form-control"
						placeholder="global search ..."
						type="text"
					/>
				</th>
			</tr>
		</thead>
		<tbody>
			<tr ng-repeat="customer in records">
				<td>{{ customer.FirstName }}</td>
				<td>{{ customer.LastName }}</td>
				<td>{{ customer.EmailAddress }}</td>
				<td>{{ customer.CompanyName }}</td>
				<td>{{ customer.City }}</td>
				<td>{{ customer.PostalCode }}</td>
				<td>{{ customer.Country }}</td>
				<td>{{ customer.PhoneNumber }}</td>
				<td class="d-flex">
					<a
						title="Edit Customer"
						href="javascript:void(0)"
						ng-click="updateCustomer(customer)"
						class="btn btn-sm btn-primary mr-2"
					>
						<i class="fa fa-pencil fa-2x"> </i>
					</a>
					<a
						title="Clone Customer"
						href="javascript:void(0)"
						ng-click="cloneCustomer(customer.CustomerID)"
						class="btn btn-sm btn-success mr-2"
					>
						<i class="fa fa-copy fa-2x"> </i>
					</a>
					<a
						title="Password reset"
						href="javascript:void(0)"
						ng-click="passwordReset(customer.EmailAddress,customer)"
						class="btn btn-sm btn-success"
					>
						<i class="fa fa-key fa-2x"> </i>
					</a>
				</td>
			</tr>
		</tbody>
		<tfoot class="text-center d-flex justify-content-center tfoot-toggle">
			<tr>
				<td colspan="12">
					<div class="paging">
						<div
							st-pagination=""
							st-template="template/st-pagination.html"
							st-items-by-page="itemsByPage"
							st-displayed-pages="7"
						></div>
					</div>
				</td>
			</tr>
		</tfoot>
	</table>
	<!-- Modal -->
</div>

<%- include footer.ejs %>
